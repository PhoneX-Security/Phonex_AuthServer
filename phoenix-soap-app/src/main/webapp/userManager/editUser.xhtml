<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:sec="http://www.springframework.org/security/tags"      >

<ui:composition template="/templates/main.xhtml">
    
        <ui:define name="title">
            <h:outputText value="${tran.BusinessCardsManagement}" /> - <h:outputText value="${tran.EditUser}" />
        </ui:define>
      	<ui:define name="header">
		<ui:include src="/templates/includes/header.xhtml" />
	</ui:define>
	
	<ui:define name="body">
		<div id="widecontent">
                    <h2><h:outputText value="${tran.EditUser}" /></h2>                    
                    <h:form>
                        <rich:graphValidator  value="#{userBean}" id="gv">
                        <h:panelGrid  id="panel" columns="3" border="0" >                              
                              <f:facet name="header">     
                                 <h:panelGroup style="display:block;">                                                                      
                                  <rich:messages for="gv" />
                                  <rich:messages globalOnly="true" />
                                 </h:panelGroup>
                              </f:facet>      
                            
                              <h:outputLabel value="${tran.Login}"  />
                              <h:outputLabel styleClass="strong" id="login" value="#{userBean.user.login}"  />
                              <rich:message ajaxRendered="true" for="login" />

                              <h:outputLabel for="fname" value="${tran.FirstName}" />
                              <h:inputText label="${tran.FirstName}" required="true" id="fname" value="#{userBean.user.firstName}" validatorMessage="${tran.TextLengthError}">
                                <f:validateLength  minimum="2" maximum="30" />                                                
                              </h:inputText>
                              <rich:message ajaxRendered="true" for="fname" />

                              <h:outputLabel for="sname" value="${tran.Surname}" />
                              <h:inputText label="${tran.Surname}" required="true" id="sname" value="#{userBean.user.surName}" validatorMessage="${tran.TextLengthError}">
                                <f:validateLength  minimum="2" maximum="30" />                                                
                              </h:inputText>
                              <rich:message ajaxRendered="true" for="sname" />

                              <h:outputLabel for="email" value="${tran.Email}" />                  
                              <h:inputText label="${tran.Email}" required="true" id="email" value="#{userBean.user.email}" validatorMessage="${tran.BadEmailFormat}">              
                                <f:validateRegex pattern="^(([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5}){1,25})+([;.](([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5}){1,25})+)*$"></f:validateRegex>                    
                              </h:inputText>   
                              <rich:message ajaxRendered="true" for="email" />
                          
                          <f:facet name="footer">
                            <h:panelGroup style="display:block; text-align:center">                  
                                <h:commandButton action="#{userBean.saveUser}" value="${tran.Save}" />
                            </h:panelGroup>
                          </f:facet>
                        </h:panelGrid>
                        </rich:graphValidator>
                    </h:form>
                    <h2><h:outputText value="${tran.ChangePassword}" /></h2>
                    <h:form id="changePass">  
                        <rich:graphValidator  value="#{userBean}" id="gvpass">
                        <h:panelGrid  id="panel" columns="3" border="0" >                                 
                            
                              <h:outputLabel for="password" value="${tran.Password}"  />
                              <h:inputSecret label="${tran.Password}" required="true" id="password" value="#{userBean.pass}" validatorMessage="${tran.PasswordLengthError}">                            
                                <f:validateLength minimum="8" maximum="30" />  
                              </h:inputSecret>
                              <rich:message ajaxRendered="true" for="password" />

                              <h:outputLabel for="confpass" value="${tran.ConfirmedPassword}"  />
                              <h:inputSecret label="${tran.ConfirmedPassword}" required="true" id="confpass" value="#{userBean.passconf}" validatorMessage="${tran.PasswordLengthError}">
                              </h:inputSecret>
                              <rich:message ajaxRendered="true" for="confpass" />
                              
                              <f:facet name="footer">
                                <h:panelGroup style="display:block; text-align:center">                  
                                  <h:commandButton action="#{userBean.savePassword}" value="${tran.Save}" />
                                </h:panelGroup>
                              </f:facet>
                        </h:panelGrid>
                            </rich:graphValidator>
                    </h:form>
                </div>
	</ui:define>
    
        <ui:define name="addcard">
        	<ui:include src="/templates/includes/addcard.xhtml" />
        </ui:define>
    
        <ui:define name="loginform">
        	<ui:include src="/templates/includes/loginform.xhtml" />
        </ui:define>
	
	<ui:define name="footer">
		<ui:include src="/templates/includes/footer.xhtml"></ui:include>
	</ui:define>
</ui:composition>

</html>
